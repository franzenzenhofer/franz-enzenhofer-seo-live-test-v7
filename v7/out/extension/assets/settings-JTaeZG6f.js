import"./modulepreload-polyfill-B5Qt9EMX.js";import{j as e,r as g,c as f}from"./client-BVdrxQBY.js";import{r as y}from"./registry-CQtYqYyA.js";import{T as j,g as p,r as v,i as N}from"./auth-DPFzHX6O.js";const m=({label:s,description:a,checked:o,onChange:t})=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:s}),e.jsx("p",{className:"text-xs text-gray-600",children:a})]}),e.jsx("div",{className:"ml-4",children:e.jsx("input",{type:"checkbox",checked:o,onChange:n=>t(n.target.checked),className:"w-4 h-4 text-blue-600 rounded cursor-pointer"})})]}),k=({autoRun:s,setAutoRun:a,autoClear:o,setAutoClear:t,preserveLog:n,setPreserveLog:c,toggleSetting:i})=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"General Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(m,{label:"Auto Run",description:"Automatically run tests when navigating to new pages",checked:s,onChange:r=>{a(r),i("ui:autoRun",r)}}),e.jsx(m,{label:"Auto Clear",description:"Clear previous results when running new tests",checked:o,onChange:r=>{t(r),i("ui:autoClear",r)}}),e.jsx(m,{label:"Preserve Log",description:"Keep logs when navigating to new pages",checked:n,onChange:r=>{c(r),i("ui:preserveLog",r)}})]})]}),_=({hasToken:s,signIn:a,signOut:o})=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Google Account"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Authentication Status"}),e.jsx("p",{className:"text-xs text-gray-600",children:s?"✓ Signed in to Google":"Not signed in"})]}),e.jsx("div",{className:"ml-4",children:s?e.jsx("button",{className:"px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",onClick:o,children:"Sign Out"}):e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",onClick:a,children:"Sign In"})})]})]}),w=({vars:s,updateVar:a})=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"API Keys & Variables"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900 flex items-center gap-2",children:["PageSpeed Insights Key",e.jsx("a",{href:"https://developers.google.com/speed/docs/insights/v5/get-started",target:"_blank",rel:"noreferrer",className:"text-xs text-blue-600 underline",children:"Docs"})]}),e.jsx("input",{className:"mt-1 block w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",type:"text",placeholder:"Enter your PSI API key",value:s.google_page_speed_insights_key||"",onChange:a("google_page_speed_insights_key")}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Required for PSI rules (mobile/desktop/FCP). Use a Google Cloud API key tied to the PageSpeed Insights API."})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Search Console Site URL"}),e.jsx("input",{className:"mt-1 block w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",type:"text",placeholder:"https://example.com/ or sc-domain:example.com",value:s.gsc_site_url||"",onChange:a("gsc_site_url")}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Used by Search Console rules (top queries, indexing). Provide the exact property identifier such as",e.jsx("code",{className:"mx-1",children:"https://example.com/"})," or ",e.jsx("code",{className:"mx-1",children:"sc-domain:example.com"}),"."]})]})})]})]}),C=y.map(s=>({id:s.id,name:s.name,enabledByDefault:s.enabled})).sort((s,a)=>s.name.localeCompare(a.name)),R=({flags:s,updateFlags:a,autoEnabled:o})=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Rule Toggles"}),e.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"Override defaults (auto = enabled when creds exist)"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto pr-1",children:C.map(t=>{const n=s[t.id],c=typeof n=="boolean"?n:o(t.id)||t.enabledByDefault;return e.jsxs("label",{className:"flex items-center justify-between p-2 bg-white rounded",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-900",children:[t.name,e.jsxs("span",{className:"block text-[10px] text-gray-500",children:[t.id,o(t.id)?" · auto":""]})]}),e.jsx("input",{type:"checkbox",className:"ml-2 w-4 h-4 text-blue-600 rounded cursor-pointer",checked:c,onChange:i=>a({...s,[t.id]:i.target.checked})})]},t.id)})})]}),S=()=>{const[s,a]=g.useState({}),[o,t]=g.useState({}),[n,c]=g.useState(!1),[i,r]=g.useState(!1),[l,u]=g.useState(!1),[x,h]=g.useState(!1);return g.useEffect(()=>{chrome.storage.local.get(["rule-flags","globalRuleVariables",j,"ui:autoClear","ui:autoRun","ui:preserveLog"],d=>{a(d["rule-flags"]||{}),t(d.globalRuleVariables||{}),r(d["ui:autoClear"]!==!1),u(d["ui:autoRun"]!==!1),h(d["ui:preserveLog"]===!0)}),p().then(d=>c(!!d)).catch(()=>{})},[]),{flags:s,setFlags:a,vars:o,setVars:t,hasToken:n,setHasToken:c,autoClear:i,setAutoClear:r,autoRun:l,setAutoRun:u,preserveLog:x,setPreserveLog:h}},A=s=>({signIn:async()=>{await N(),s(!!await p())},signOut:async()=>{await v(),s(!1)}}),I=[{id:"psi:mobile",vars:["google_page_speed_insights_key"]},{id:"psi:desktop",vars:["google_page_speed_insights_key"]},{id:"psi:mobile-fcp-tbt",vars:["google_page_speed_insights_key"]},{id:"gsc:property-available",token:!0},{id:"gsc:is-indexed",vars:["gsc_site_url"],token:!0},{id:"gsc:top-queries-of-page",vars:["gsc_site_url"],token:!0},{id:"gsc:page-worldwide",vars:["gsc_site_url"],token:!0},{id:"gsc:directory-worldwide",vars:["gsc_site_url"],token:!0}],P=(s,a)=>!s||s.every(o=>{const t=a==null?void 0:a[o];return typeof t=="string"?t.trim().length>0:!!t}),L=(s,a,o)=>{const t=I.find(n=>n.id===s);return!t||t.token&&!o?!1:P(t.vars,a)},T=()=>{const s=S(),{signIn:a,signOut:o}=A(s.setHasToken),t=chrome.runtime.getManifest().version,n=l=>{s.setFlags(l),chrome.storage.local.set({"rule-flags":l})},c=l=>u=>{const x={...s.vars,[l]:u.target.value};s.setVars(x),chrome.storage.local.set({globalRuleVariables:x})},i=(l,u)=>chrome.storage.local.set({[l]:u}),r=l=>L(l,s.vars,s.hasToken);return e.jsx("div",{className:"min-h-screen bg-white",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-4 sm:p-6",children:[e.jsxs("div",{className:"border-b pb-4 mb-6",children:[e.jsxs("h1",{className:"text-2xl font-semibold flex items-center gap-2",children:["Live Test Settings ",e.jsxs("span",{className:"text-sm text-gray-500",children:["v",t]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure extension behavior and API keys"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(k,{autoRun:s.autoRun,setAutoRun:s.setAutoRun,autoClear:s.autoClear,setAutoClear:s.setAutoClear,preserveLog:s.preserveLog,setPreserveLog:s.setPreserveLog,toggleSetting:i}),e.jsx(_,{hasToken:s.hasToken,signIn:a,signOut:o}),e.jsx(w,{vars:s.vars,updateVar:c}),e.jsx(R,{flags:s.flags,updateFlags:n,autoEnabled:r})]})]})})},b=document.getElementById("root");if(!b)throw new Error("Root element not found");f(b).render(e.jsx(T,{}));
