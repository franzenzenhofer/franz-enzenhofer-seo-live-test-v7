const r="lastActiveTab",n=/^(chrome|edge|about|devtools|view-source|chrome-extension):/i,s=e=>!!(e&&n.test(e)),o=async e=>chrome.storage.session.set({[r]:e}).catch(()=>{}),a=async()=>{try{const{[r]:e}=await chrome.storage.session.get(r);return typeof e=="number"?e:null}catch{return null}},i=async()=>{try{const t=(await chrome.tabs.query({lastFocusedWindow:!0})).find(c=>c.id&&!s(c.url));return(t==null?void 0:t.id)??null}catch{return null}},u=async e=>{try{const t=await chrome.tabs.get(e);if(!(t!=null&&t.id)||s(t.url))return;await o(t.id)}catch{}},d=async()=>{try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(t!=null&&t.id&&!s(t.url))return t.id}catch{}const e=await a();return e||i()};export{d as a,s as i,u as r};
