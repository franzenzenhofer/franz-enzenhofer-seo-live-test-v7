function W(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var L={exports:{}};(function(l){function r(f,y,v="Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)"){let E=f.split(`
`),x="",h="",c=[],k=v.toLowerCase(),b=new URL(y),m=b.pathname+b.search,g=new Map,C=!1,_=new Map;hashCode=function(a){return a.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0)};let M=a=>new Map([...a.entries()].sort((e,t)=>e[0]<t[0]?1:e[0]>t[0]?-1:0)),O=(a,e)=>(x=a,{key:a,value:e}),P=a=>{let e=new RegExp("[.+?|()\\[\\]{}\\\\]","g");return a.replace(e,"\\$&")},j=(a=k,e=c)=>{let t=!1;a=a.toLowerCase();const o=hashCode(e.join()+a);if(_.get(o)!==void 0)return _.get(o);for(let s of e)s=s.toLowerCase(),s=s.trim(),s!=""&&(a.includes(s)||s==="*")&&(s===h||s.length>h.length?(t=!0,h=s):s!=h&&s.length===h.length&&(t=!0,h=s,C=!0));return _.set(o,t),t},R=(a,e,t,o,n,s,K)=>{if(t=t.trim(),!t)return!1;let i=P(t);i=i.replace(/\*/g,".*"),!i.endsWith("$")&&!i.endsWith("*")&&t!=""&&(i=i+".*"),i="^"+i;let U=new RegExp(i);return m.match(U)?{path:m,prio:t.length,linenumber:n,rule:o,regex:i,key:e,value:t,"user-agent":s,"user-agent-match":K}:!1},A=0;for(let a of E){A++;let e=a.trim();if(e!==""){if(!e.startsWith("#")){if(e.includes(":")){e.includes("#")&&(e=e.substring(0,e.indexOf("#")));let t=e.substring(0,e.indexOf(":")).trim(),o=e.substring(e.indexOf(":")+1).trim();if(t=t.toLowerCase(),t==="user-agent")x==="user-agent"||(c=[]),c.push(o);else if((t==="disallow"||t==="allow"||t==="noindex")&&c.length>0&&j(k,c)){let n=R(m,t,o,e,A,v,c);n&&(g.get(n.prio)?g.get(n.prio).push(n):g.set(n.prio,[n]))}O(t,o)}}}}const d=M(g);let u={url:y,path:m,matches:Array.from(d),allowed:!0,disallowed:!1,noindex:!1,rule_match:!1,conflict:!1,user_agent_match_collision:!1};if(C&&(u.user_agent_match_collision=!0),d.size>0){u.rule_match=!0;let a=d.values().next().value,e=!1,t=!1;for(let o of a)o.key==="disallow"&&(u.disallowed=!0,u.allowed=!1,t=!0),o.key==="allow"&&(e=!0);e&&t&&(u.conflict=!0);for(let[o,n]of d)for(let s of n)s.key==="noindex"&&(u.noindex=!0)}return u}l.exports=r})(L);var z=L.exports;const I=W(z),p="googleApiAccessToken",T=async()=>{const{[p]:l}=await chrome.storage.local.get(p);return l||null},w=async l=>{l?await chrome.storage.local.set({[p]:l}):await chrome.storage.local.remove(p)},S=async()=>{const l=await T();return l?new Promise(r=>{chrome.identity.getAuthToken({interactive:!1},f=>{f?w(f).then(()=>r(f)).catch(()=>r(f)):r(l)})}):null},$=async()=>new Promise(l=>{chrome.identity.getAuthToken({interactive:!0},r=>{r?w(r).then(()=>l(r)).catch(()=>l(r)):l(null)})}),q=async()=>{const l=await T();l&&(await fetch("https://accounts.google.com/o/oauth2/revoke?token="+l),await new Promise(r=>chrome.identity.removeCachedAuthToken({token:l},()=>r(null))),await w(null))};export{p as T,q as a,T as g,$ as i,I as p,S as r};
